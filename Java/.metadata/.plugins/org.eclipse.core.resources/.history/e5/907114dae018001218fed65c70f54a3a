package protodebugger.commands;

import java.util.LinkedHashMap;
import java.util.Map;

import org.eclipse.core.commands.ExecutionEvent;
import org.eclipse.core.commands.ExecutionException;
import org.eclipse.core.commands.IHandler2;
import org.eclipse.core.commands.IHandlerListener;
import org.eclipse.jface.viewers.LabelProvider;
import org.eclipse.jface.window.Window;
import org.eclipse.ui.PlatformUI;
import org.eclipse.ui.dialogs.ElementListSelectionDialog;
import org.test.Simple;

import com.google.protobuf.GeneratedMessage;

public class ProtoSelection implements IHandler2 {

	private ElementListSelectionDialog dialog;
	private Map<String, GeneratedMessage> messageList = new LinkedHashMap<String, GeneratedMessage>();
	{
		messageList.put("Simple", Simple.SimpleExample.getDefaultInstance());
	}
	@Override
	public Object execute(ExecutionEvent event) throws ExecutionException {
		if(dialog == null){
			dialog = new ElementListSelectionDialog(PlatformUI.getWorkbench().getDisplay().getActiveShell()
					, new LabelProvider());
			dialog.setElements(messageList.keySet().toArray());
			dialog.setTitle("Select Proto Message");
			dialog.setMessage("Select a String (* = any string, ? = any char) :");
		}
		
		//System.out.println("The result is " + result + " SWT.OK is " + SWT.OK);
		if (dialog.open() == Window.OK){
			messageList.get(dialog.getFirstResult());
		}
		return null;
	}

	@Override
	public boolean isEnabled(){
		return true;
	}

	@Override
	public void addHandlerListener(IHandlerListener handlerListener) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void dispose() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public boolean isHandled() {
		// TODO Auto-generated method stub
		return true;
	}

	@Override
	public void removeHandlerListener(IHandlerListener handlerListener) {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void setEnabled(Object evaluationContext) {
		// TODO Auto-generated method stub
		
	}
	

}
